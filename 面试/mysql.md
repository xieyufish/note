# MySql

## 1. Mysql中的存储引擎有哪些？

存储引擎的作用就是告诉mysql如何存储数据、如何为存储的数据建立索引、如何更新和查询数据的一种实现方式。mysql中的存储引擎有：

1. MyISAM：最早实现的存储引擎，一个myisam表对应文件系统中的三个文件，分别为frm(表结构定义)、MYD(表数据)和MYI(表索引)；mysql中有三种类型的MyISAM存储引擎，分别如下：

   - 静态MyISAM：如果数据表中的各数据列的长度都是预先固定好的(意思就是说数据列的数据类型没有varchar， blob，text等这些可变长数据类型)，服务器将自动选择这种存储类型。因为数据表中每一条记录所占用的空间都是一样的，所以这种表存取和更新的效率非常高。当数据受损时，恢复工作也比较容易做；
   - 动态MyISAM：如果数据表中出现varchar、xxxtext或xxxBLOB字段时，服务器将自动选择这种存储类型；
   - 压缩MyISAM：以上说到的两种类型的表都可以用myisamchk工具压缩。这种类型的表进一步减小了占用的存储，但是这种表压缩之后不能再被修改。另外，因为是压缩数据，所以这种表在读取的时候要先进行解压缩。

   MyISAM存储引擎不支持事务、行级锁和外键约束的功能。

2. MyISAM merge：是MyISAM存储引擎的一个变种，将几个相同的MyISAM表合并为一个虚表，常用于日志和数据仓库；

3. InnoDB：提供了事物、行级锁和外键约束的功能，是现在Mysql默认的存储引擎；

4. Memory：这种存储引擎的数据表只存在于内存中。数据存取的数据快，一般用作缓存表或者是查询过程中的临时中间表；由于数据存在于内存中，所以如果关闭数据库，数据将会丢失；

5. Archive：这种类型只支持select 和 insert语句，而且不支持索引。常应用于日志记录和聚合分析方面。

## 2. 锁了解吗？有哪些类型？

按照锁定的粒度（跟数据存储结构有关的）可以分为：表级锁、页级锁和行级锁。

- 表级锁：是mysql中最大颗粒度的锁定机制，锁定的是操作的整张表；实现逻辑非常简单，带来的系统负面影响最小，获取锁和释放锁的速度很快；最大的负面影响是出现锁定资源争用的概率也会最高，并行度大打折扣；此外，表级别的锁定不会产生死锁问题。myisam和innodb都支持这种锁级别；
- 页级锁：是mysql中比较独特的一种锁定级别，颗粒度介于表级锁和行级锁之间，所以获取锁定所需要的资源开销，以及所能提供的并发处理能力也同样是介于上面二者之间。当然，也会产生死锁问题；
- 行级锁：锁定的是数据库表中的一行数据，锁定对象的颗粒度是最小的，由于锁定颗粒度很小，所以发生锁定资源争用的概率也最小，能够给予应用程序尽可能大的并发处理能力而提高一些需要高并发应用系统的整体性能。由于锁定资源的颗粒度很小，所以每次获取锁和释放锁需要做的事情也更多，带来的消耗自然也就更大了。此外，行级锁定也最容易发生死锁；innodb支持这种锁级别。

按照锁的性质可以分为：共享锁(S锁)和独享锁(X锁，也叫排它锁)

- 共享锁：允许持有共享锁的事物读取一行数据，因此也叫读锁；
- 独占锁：允许持有独占锁的事物更新或删除一行，也叫写锁；

[参考](https://www.cnblogs.com/lsxuejava/p/7305920.html)

## 2. mysql中的事物隔离级别？

因为只有InnoDB存储引擎支持事务，所以说道mysql中的事物隔离级别，就是说的InnoDB存储引擎中的事务隔离级别。InnoDB提供和支持如下4种事务隔离级别：

- REPEATABLE READ(可重复读)
  InnoDB默认的隔离级别。在同一个事物中的连续读是通过读取事物里第一个读操作建立的快照实现的。也就是说即使有其他的事务修改了这个记录的值，这个事物中的快照也不会去刷新新值，这样可以保证这个事务中多次读到的总是同一个值；这种隔离级别可以防止不可重复读；
- READ COMMITTED
  每一个连续读，即使这些连续的操作是在同一个事物中，每次读也都是读取这个事务刷新快照后的结果。也就是说如果有其他事务修改了记录的值并提交了，那么这个事务中的快照会刷新，这样第二次读就会读到新值。这也造成了不可重复读的问题，修复了脏读的现象。注意这种隔离级别下，针对区间列行的操作会出项幻读。
- READ UNCOMMITTED
  select语句以非锁状态执行，一个早期的提交值可能会被使用，也就是出现脏读，其他方面和READ COMMITTED一样；
- SERIALIZABLE
  跟REPEATABLE READ类似，但是如果autocommit是disabled，那么innodb会隐含的将所有简单的select语句转化为select... lock in share mode。如果autocommit是enabled，那么select语句就是单独的一个事物。

